# 本体设计图

![ATT&CK本体6.drawio (1)](%E6%9C%AC%E4%BD%93%E8%AE%BE%E8%AE%A1.assets/ATT&CK%E6%9C%AC%E4%BD%936.drawio%20(1).png)

# ATT&CK

数据源是json格式，单文件

## Technique

（子）攻击技术是实现攻击目标时使用的技术，从ATT&CK数据库构建。

子攻击技术是攻击技术的相似的本体。

达成阶段目标所执行的手法→策略中的技巧与技术

对象类别：attack-pattern

### 属性

|     属性      |           意义           | 样例                                                         |      对象中的名字       |
| :-----------: | :----------------------: | ------------------------------------------------------------ | :---------------------: |
|      ID       | ATT&CK中攻击技术的标识号 | T1518<br />T1518.001                                         |   external_references   |
|     Name      |  ATT&CK中攻击技术的名字  | Software Discovery                                           |          name           |
| Subtechnique  |       是不是子技术       | True/False                                                   | x_mitre_is_subtechnique |
|  Description  |     对攻击技术的描述     | Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as firewall rules and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. |       description       |
|   Detection   |  攻击技术对应的检测简述  | Examine data in user’s SID-History attributes using the PowerShell `Get-ADUser` cmdlet [[10\]](https://technet.microsoft.com/library/ee617241.aspx), especially users who have SID-History values from the same domain. [[11\]](https://adsecurity.org/?p=1772) Also monitor account management events on Domain Controllers for successful and failed changes to SID-History. [[11\]](https://adsecurity.org/?p=1772) [[12\]](https://msdn.microsoft.com/library/ms677982.aspx) |    x_mitre_detection    |
|    Version    |        实体的版本        | 2.0                                                          |     x_mitre_version     |
|    Created    |      实体创建的时间      | 30 January 2020                                              |         created         |
| Last Modified |    实体上次修改的时间    | 22 July 2020                                                 |        modified         |
|    Domain     |           领域           | ["enterprise-attack" ]                                       |     x_mitre_domains     |
|   Platform    |           平台           | ["Linux","Windows","macOS"]                                  |    x_mitre_platforms    |
|    stix_id    |      对象的唯一ID号      | attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b         |           id            |



### 关系

|     Subject     | relationship |      Object      |                        意义                        |
| :-------------: | :----------: | :--------------: | :------------------------------------------------: |
|    Technique    |   superior   |  Sub Technique   |             攻击技术是子攻击技术的父亲             |
|    Technique    |    belong    |      Tactic      |                 攻击技术所属的战术                 |
| (Sub) Technique |   applyto    |     Platform     |                 攻击技术应用的平台                 |
| (Sub) Technique |   required   |    Permission    |               攻击技术需要的用户权限               |
| (Sub) Technique |     gain     |    Permission    |           通过执行该技术将获得的权限级别           |
| (Sub) Technique |    refer     |    Reference     |                      参考文献                      |
| (Sub) Technique |    bypass    | Defense Bypassed | 攻击技术可用于绕过或解决特定的防御工具、方法或过程 |
| (Sub) Technique |    impact    |    ImpactType    |            攻击技术攻击的完整性或可用性            |

## Platform

平台，表示攻击技术适用于哪个平台，从ATT&CK数据库构建

### 属性

| 属性 | 意义 | 样例 | 对象中的名字      |
| :--: | :--: | :--: | ----------------- |
| Name | 平台 | PRE  | x_mitre_platforms |

## Permission

权限，表示攻击技术需要的权限或是攻击技术获得的权限，从ATT&CK数据库构建，来自于Technique属性Permission

### 属性

| 属性 |  意义  | 样例 | 对象中的名字                           |
| :--: | :----: | :--: | -------------------------------------- |
| Name | 权限名 | root | x_mitre_permissions_required<br />gain |

## Defense_Bypassed

防御绕过，用来绕过或逃避一个特定的防御工具，方法或过程，仅适用于防御闪避(子)技术，从ATT&CK数据库构建，来自于Technique属性x_mitre_impact_type

### 属性

| 属性 | 意义 |   样例   | 对象中的名字             |
| :--: | :--: | :------: | ------------------------ |
| Name | 名称 | Firewall | x_mitre_defense_bypassed |

## Impact_Type

攻击技术影响的完整性或可用性，从ATT&CK数据库构建，来自于Technique属性x_mitre_impact_type

### 属性

| 属性 | 意义 |     样例     | 对象中的名字        |
| :--: | :--: | :----------: | ------------------- |
| Name | 名称 | Availability | x_mitre_impact_type |


## Tactic

战术表示攻击者的攻击目标，从ATT&CK数据库构建。

攻击者预期达成的目标→该阶段的目标，定义战术与策略

对象类别：x-mitre-tactic

### 属性

|     属性      |           意义           |                             样例                             |   对象中的名字    |
| :-----------: | :----------------------: | :----------------------------------------------------------: | :---------------: |
|      ID       | ATT&CK中攻击战术的标识号 |                            TA0009                            |        ID         |
|     Name      |  ATT&CK中攻击战术的名字  |                          Collection                          | x_mitre_shortname |
|  Description  |     对攻击战术的描述     | The adversary is trying to gather data of interest to their goal.\nCollection consists of techniques adversaries may use to gather information and the sources information is collected from that are relevant to following through on the adversary's objectives. Frequently, the next goal after collecting data is to steal (exfiltrate) the data. Common target sources include various drive types, browsers, audio, video, and email. Common collection methods include capturing screenshots and keyboard input. |    description    |
|    Domain     |      战术属于的领域      |                      enterprise-attack                       |  x_mitre_domains  |
|    Version    |           版本           |                             1.0                              |  x_mitre_version  |
|    Created    |      实体创建的时间      |                       30 January 2020                        |      created      |
| Last Modified |    实体上次修改的时间    |                         22 July 2020                         |     modified      |
|    stix_id    |      对象的唯一ID号      |     attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b     |        id         |

### 关系

| Subject | relationship |  Object   | 意义     |
| :-----: | :----------: | :-------: | -------- |
| Tactic  |    refer     | Reference | 参考文献 |

## Group

攻击组织，从ATT&CK数据库构建。

对象类比：intrusion-set

### 属性

| 属性              | 意义               | 样例                                                         | 对象中的名字      |
| ----------------- | ------------------ | ------------------------------------------------------------ | ----------------- |
| ID                | 事件的标识号       | G0050                                                        | ID                |
| Name              | 事件的名字         | APT32                                                        | name              |
| Description       | 对事件的描述       | [APT32](https://attack.mitre.org/groups/G0050) is a suspected Vietnam-based threat group that has been active since at least 2014. The group has targeted multiple private sector industries as well as foreign governments, dissidents, and journalists with a strong focus on Southeast Asian countries like Vietnam, the Philippines, Laos, and Cambodia. They have extensively used strategic web compromises to compromise victims.[[1\]](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)[[2\]](https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/)[[3\]](https://www.welivesecurity.com/2018/03/13/oceanlotus-ships-new-backdoor/) | description       |
| Associated Groups | 事件相关联的组织   | SeaLotus, OceanLotus, APT-C-00                               | aliases           |
| Version           | 实体的版本         | 2.5                                                          | x_mitre_version   |
| Created           | 实体创建的时间     | 30 January 2020                                              | created           |
| Last Modified     | 实体上次修改的时间 | 22 July 2020                                                 | modified          |
| Domain            | 领域               | ["enterprise-attack" ]                                       | x_mitre_domains   |
| Platform          | 平台               | ["Linux","Windows","macOS"]                                  | x_mitre_platforms |
| stix_id           | 对象的唯一ID号     | attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b         | id                |

### 关系

|     Subject     | relationship |  Object   | 意义                       |
| :-------------: | :----------: | :-------: | -------------------------- |
| (Sub) Technique |     used     |   Group   | （子）攻击技术在事件中使用 |
|      Event      |    employ    | Software  | 事件使用软件工具           |
|      Group      |  associated  |   Group   | 组织相关的组织             |
|      Event      |    refer     | Reference | 参考文献                   |

## Software

攻击使用的软件，从ATT&CK数据库构建。

对象来源：tool和malware

### 属性

|     属性      |        意义        |                             样例                             |   对象中的名字    |
| :-----------: | :----------------: | :----------------------------------------------------------: | :---------------: |
|      ID       | 工具/软件的标识号  |                            S0002                             |        ID         |
|     Name      |  工具/软件的名字   |                           Mimikatz                           |       name        |
|  Description  |  工具/软件的描述   | [Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. [[1\]](https://github.com/gentilkiwi/mimikatz) [[2\]](https://adsecurity.org/?page_id=1821) |    description    |
|     type      |  工具/软件的类型   |                           MALWARE                            |       type        |
|    Version    |     实体的版本     |                             2.5                              |  x_mitre_version  |
|    Created    |   实体创建的时间   |                       30 January 2020                        |      created      |
| Last Modified | 实体上次修改的时间 |                         22 July 2020                         |     modified      |
|    Domain     |        领域        |                    ["enterprise-attack" ]                    |  x_mitre_domains  |
|   Platform    |        平台        |                 ["Linux","Windows","macOS"]                  | x_mitre_platforms |
|    stix_id    |   对象的唯一ID号   |     attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b     |        id         |

### 关系

|     Subject     | relationship |  Object   |           意义           |
| :-------------: | :----------: | :-------: | :----------------------: |
| (Sub) Technique |   utilized   | Software  | （子）攻击技术被组织使用 |
|    Software     |   applyto    | Platform  |    软件使用于哪个平台    |
|    Software     |    refer     | Reference |         参考文献         |

## Mitigation

缓解攻击的方法，从ATT&CK数据库构建。

对象类别：course-of-action

### 属性

|     属性      |        意义        |                             样例                             |  对象中的名字   |
| :-----------: | :----------------: | :----------------------------------------------------------: | :-------------: |
|      ID       |       标识号       |                            M1046                             |       ID        |
|     Name      |        名字        |                        Boot Integrity                        |      name       |
|  Description  |        描述        | Use secure methods to boot a system and verify the integrity of the operating system and loading mechanisms. |   description   |
|    Version    |     实体的版本     |                             1.0                              | x_mitre_version |
|    Created    |   实体创建的时间   |                         11 June 2019                         |     created     |
| Last Modified | 实体上次修改的时间 |                         19 May 2020                          |    modified     |
|    Domain     |     属于的领域     |                    ["enterprise-attack" ]                    | x_mitre_domains |

### 关系

|     Subject     | relationship |   Object   | 意义                           |
| :-------------: | :----------: | :--------: | ------------------------------ |
| (Sub) Technique |   defended   | Mitigation | （子）攻击技术被缓解措施所防御 |
|   Mitigation    |    refer     | Reference  | 参考文献                       |

## DataSource

数据源，代表可以由传感器/日志收集的信息的各种主题/主题。

从ATT&CK数据库构建。

对象类别：x-mitre-data-source

### 属性

|     属性      |        意义        |                             样例                             |   对象中的名字    |
| :-----------: | :----------------: | :----------------------------------------------------------: | :---------------: |
|      ID       |       标识号       |                            M1046                             |        ID         |
|     Name      |        名字        |                        Boot Integrity                        |       name        |
|  Description  |        描述        | Use secure methods to boot a system and verify the integrity of the operating system and loading mechanisms. |    description    |
|    Version    |     实体的版本     |                             1.0                              |  x_mitre_version  |
|    Created    |   实体创建的时间   |                         11 June 2019                         |      created      |
| Last Modified | 实体上次修改的时间 |                         19 May 2020                          |     modified      |
|    Domain     |        领域        |                    ["enterprise-attack" ]                    |  x_mitre_domains  |
|   Platform    |        平台        |                 ["Linux","Windows","macOS"]                  | x_mitre_platforms |
|    stix_id    |   对象的唯一ID号   |     attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b     |        id         |

### 关系

|  Subject   | relationship |      Object      | 意义                         |
| :--------: | :----------: | :--------------: | ---------------------------- |
| DataSource |   collect    | Collection_Layer | 对数据源的物理收集位置的描述 |
| DataSource |    refer     |    Reference     | 参考文献                     |
| DataSource |   applyto    |     Platform     | 数据源来自于哪个平台         |

## Collection_Layer

物理收集位置：对数据源的物理收集位置的描述，从ATT&CK数据库构建，来自于DataSource属性x_mitre_collection_layers

### 属性

| 属性 | 意义 |                   样例                   | 对象中的名字              |
| :--: | :--: | :--------------------------------------: | ------------------------- |
| Name | 名称 | ["Host","Network","Cloud Control Plane"] | x_mitre_collection_layers |

## DataComponent

数据组件，这些组件标识与检测给定 ATT&CK 技术或子技术相关的数据源的特定属性/值。

从ATT&CK数据库构建。

对象类别：x-mitre-data-component

### 属性

|     属性      |        意义        |                             样例                             |  对象中的名字   |
| :-----------: | :----------------: | :----------------------------------------------------------: | :-------------: |
|      ID       |       标识号       |                            M1046                             |       ID        |
|     Name      |        名字        |                        Boot Integrity                        |      name       |
|  Description  |        描述        | Use secure methods to boot a system and verify the integrity of the operating system and loading mechanisms. |   description   |
|    Version    |     实体的版本     |                             1.0                              | x_mitre_version |
|    Created    |   实体创建的时间   |                         11 June 2019                         |     created     |
| Last Modified | 实体上次修改的时间 |                         19 May 2020                          |    modified     |
|    stix_id    |   对象的唯一ID号   |     attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b     |       id        |

### 关系

|    Subject    | relationship |    Object     | 意义                   |
| :-----------: | :----------: | :-----------: | ---------------------- |
| DataComponent |  component   |  DataSource   | 数据组件属于什么数据源 |
|   Technique   |  influence   | DataComponent | 攻击技术影响数据组件   |

# Engage

数据源是json格式，多文件

## Activity

在交战中防御方使用的活动，来源于Engage的Activities，来自文件activity_details.json。

Engage的Activities类型还有Strategic 类型，但是缺乏和别的本体的关系，所以忽略，参考：https://engage.mitre.org/activities/SAC0005/

对象的类别：activity_details

### 属性

| 属性        | 意义   | 样例                                                         | 对象中的名字     |
| ----------- | ------ | ------------------------------------------------------------ | ---------------- |
| ID          | 标识号 | EAC0004                                                      | id               |
| Name        | 名字   | Network Analysis                                             | name             |
| Description | 描述   | Analyze network traffic to gain intelligence on communications between systems.\nNetwork analysis can be an automated or manual task to review communications between systems to expose adversary activity, such as C2 or data exfiltration traffic. This analysis is normally done by capturing and analyzing traffic on the wire or from previously collected packet capture. | long_description |
| Type        | 类别   | Engagement                                                   | type             |

### 关系

|     Subject     | relationship |  Object   | 意义                         |
| :-------------: | :----------: | :-------: | ---------------------------- |
|    Activity     |    belong    |   Goal    | 活动的目标                   |
|    Activity     |    refer     | Reference | 参考文献                     |
|    Activity     |    belong    | Approache | 活动的途径                   |
| (Sub) Technique |   counted    | Activity  | 活动对应的攻击技术           |
|     Tactic      |   counted    | Activity  | 活动对应的攻击战术           |
|    Activity     |   exposed    |    Eav    | 活动能够引发攻击者的缺陷缺点 |

## Goal

防御技术的目标，来源于Engage的goal_details.json。

### 属性

| 属性        | 意义   | 样例                                                         | 对象中的名字     |
| ----------- | ------ | ------------------------------------------------------------ | ---------------- |
| ID          | 标识号 | EGO0001                                                      | id               |
| Name        | 名字   | Expose                                                       | name             |
| Description | 描述   | Expose is about discovering previously undetected adversaries engaging in one of two behaviors. First, the adversary may be attempting to gain access to the networks. Second, the adversary may be currently operating on the networks. Both categories of adversary behavior contain vulnerabilities that can be advantageous for a defender seeking to expose the adversary. <br/>...<br />In many cases, the activities that support such Collection and Detection approaches are also good cybersecurity practices. However, in Engage, these activities will focus exclusively on the intersection of denial, deception, and adversary engagement technologies and the defender\u2019s ability to Expose the adversary. | long_description |
| Type        | 类别   | Engagement                                                   | type             |

### 关系

| Subject | relationship |  Object   | 意义       |
| :-----: | :----------: | :-------: | ---------- |
|  Goal   |    belong    | Approache | 目标的途径 |

## Approache

防御技术的途径，来源于Engage的approach_details.json。

### 属性

| 属性        | 意义   | 样例                                                         | 对象中的名字     |
| ----------- | ------ | ------------------------------------------------------------ | ---------------- |
| ID          | 标识号 | EAP0001                                                      | id               |
| Name        | 名字   | Collect                                                      | name             |
| Description | 描述   | Collection activities are used to gather information about an adversary or their activities. This collection can include gathering system logs, network traffic, adversary artifacts, or other data that can be used to expose adversary activity. In many cases, collection activities are also good cybersecurity practices. However, in Engage, these activities will focus exclusively on the intersection of denial, deception, and adversary engagement technologies and the defender\u2019s ability to Expose the adversary. | long_description |
| Type        | 类别   | Engagement                                                   | type             |

### 关系

| Subject  | relationship |  Object   | 意义       |
| :------: | :----------: | :-------: | ---------- |
|   Goal   |    belong    | Approache | 目标的途径 |
| Activity |    belong    | Approache | 活动的途径 |

## Eav

攻击者的缺陷缺点，来源于Engage的Activities的属性vulnerabilities。

### 属性

| 属性        | 意义         | 样例                                                         | 对象中的名字 |
| ----------- | ------------ | ------------------------------------------------------------ | ------------ |
| TacticID    | 所属的战术ID | TA0007                                                       | id           |
| Key         | 标识号       | EAV0011                                                      | key          |
| Name        | 名字         | Collect                                                      | name         |
| Description | 描述         | When adversaries use previously stolen information to access or move laterally within an environment, they may reveal previous collection activities. | eav          |

# CAPEC

数据源是csv格式，单文件

## Capec

**“攻击模式”是对攻击者利用网络能力中已知弱点所采用的常见属性和方法的描述。**攻击模式定义了对手可能面临的挑战以及他们如何解决这些挑战。来源于CAPEC的Attack Pattern。

### 属性

| 属性                 | 意义                | 样例                                                         | 对象中的名字         |
| -------------------- | ------------------- | ------------------------------------------------------------ | -------------------- |
| ID                   | 标识号              | CAPEC-125                                                    | ID                   |
| Name                 | 名字                | Flooding                                                     | Name                 |
| Description          | 描述                | An adversary consumes the resources of a target by rapidly engaging in a large number of interactions with the target. This type of attack generally exposes a weakness in rate limiting or flow. When successful this attack prevents legitimate users from accessing the service and can cause the target to crash. This attack differs from resource depletion through leaks or allocations in that the latter attacks do not rely on the volume of requests made to the target but instead focus on manipulation of the target's operations. The key factor in a flooding attack is the number of requests the adversary can make in a given period of time. The greater this number, the more likely an attack is to succeed against a given target. | Description          |
| Abstraction          | 攻击模式的层级/类型 | Category、Meta、Attack 、Detailed、Standard                  | Abstraction          |
| Likelihood_Of_Attack | 攻击的可能性        | High                                                         | Likelihood Of Attack |
| Typical_Severity     | 典型严重性          | Medium                                                       | Typical Severity     |
| Execution_Flow       | 执行流程            | **Survey network to identify target:** The adversary performs network reconnaissance by monitoring relevant traffic to identify the network path and parsing of the HTTP messages with the goal of identifying potential targets. | Execution Flow       |
| Prerequisites        | 攻击模式的先决条件  | Any target that services requests is vulnerable to this attack on some level of scale. | Prerequisites        |
| Skills_Required      | 所需技能            | ::SKILL:In order to discover unrestricted resources, the attacker does not need special tools or skills. They only have to observe the resources or access mechanisms invoked as each action is performed and then try and access those access mechanisms directly.:LEVEL:Low:: | Skills Required      |
| Resources_Required   | 所需资源            | A script or program capable of generating more requests than the target can handle, or a network or cluster of objects all capable of making simultaneous requests. | Resources Required   |
| Indicators           | 攻击模型的指示器    | Differences in requests processed by the two agents. This requires careful monitoring or a capable log analysis tool. | Indicators           |
| Consequences         | 攻击模式造成的结果  | ::SCOPE:Confidentiality:SCOPE:Access Control:SCOPE:AuthorizationTECHNICAL IMPACT:Gain Privileges:: | Consequences         |
| Mitigations          | 缓解措施            | Design: evaluate HTTP agents prior to deployment for parsing/interpretation discrepancies.\nConfiguration: front-end HTTP agents notice ambiguous requests.\nConfiguration: back-end HTTP agents reject ambiguous requests and close the network connection. | Mitigations          |
| Example_Instances    | 实例                | Microsoft Internet Explorer versions 5.01 SP4 and prior, 6.0 SP2 and prior, and 7.0 contain a vulnerability that could allow an unauthenticated, remote adversary to conduct HTTP request splitting and smuggling attacks. The vulnerability is due to an input validation error in the browser that allows adversaries to manipulate certain headers to expose the browser to HTTP request splitting and smuggling attacks. Attacks may include cross-site scripting, proxy cache poisoning, and session fixation. In certain instances, an exploit could allow the adversary to bypass web application firewalls or other filtering devices. Microsoft has confirmed the vulnerability and released software updates. | Example Instances    |
| Notes                | 攻击模式的参考信息  | TYPE:Other:NOTE:White box analysis techniques include file or binary analysis, debugging, <br />...<br />methods described are those commonly applied to a binary executable file and provide means for reverse engineering the file by revealing the hidden functions of its operation or composition.:: | Note                 |

### 关系

|     Subject     |                         relationship                         |   Object    | 意义                                             |
| :-------------: | :----------------------------------------------------------: | :---------: | ------------------------------------------------ |
|      Capec      |                           superior                           |    Capec    | 攻击模式有层级，有些攻击模式是别的攻击模式的子集 |
|      Capec      | Alter Execution Logic: 17,<br/>Bypass Protection Mechanism: 81,<br/>Execute Unauthorized Commands: 265,<br/>Gain Privileges: 379,<br/>Hide Activities: 121,<br/>Modify Data: 116,<br/>Other: 101,<br/Read Data: 191,<br/>Resource Consumption: 33,<br/>Unreliable Execution: 34,<br/>unknown: 2 | Consequence | 攻击模式会造成多种后果                           |
| (Sub) Technique |                          associate                           |    Capec    | （子）攻击技术相关的攻击模式                     |
|      Capec      |                           related                            |     CWE     | 与攻击模式相关的漏洞                             |

## Consequence

攻击模式可能会造成的结果：来自于Capec属性Consequences

### 属性

| 属性  | 意义 |     样例      | 对象中的名字 |
| :---: | :--: | :-----------: | ------------ |
| SCOPE | 名称 | Authorization | SCOPE        |

# CWE

数据源是csv格式，单文件

## CWE

CWE（Common Weakness Enumeration，通用缺陷枚举）。来源于CWE的CWE。

### 属性

属性类型打上问号表示类型未知

| 属性                  | 意义                           | 样例                                                         | 对象中的名字          |
| --------------------- | ------------------------------ | ------------------------------------------------------------ | --------------------- |
| ID                    | 标识号                         | CWE-287                                                      | CWE-ID                |
| Name                  | 名字                           | Improper Authentication                                      | Name                  |
| Abstraction           | 层级                           | Variant                                                      | Weakness Abstraction  |
| Status                | 状态                           | Draft                                                        | Status                |
| Description           | 描述                           | When an actor claims to have a given identity, the software does not prove or insufficiently proves that the claim is correct. | Description           |
| Extended_Description  | 额外的描述                     | If an attacker can guess or steal a session ID, then they may be able to take over the user's session (called session hijacking). The number of possible session IDs increases with increased session ID length, making it more difficult to guess or steal a session ID. | Extended Description  |
| Weakness_Ordinalities | 漏洞的主观性？漏洞的具体信息？ | ::ORDINALITY:Resultant:DESCRIPTION:This weakness is usually resultant from other weaknesses.:: | Weakness Ordinalities |
| Applicable_Platforms  | 适用的平台                     | ::LANGUAGE NAME:Java:LANGUAGE PREVALENCE:Undetermined::      | Applicable Platforms  |
| Alternate_Terms       | 别名                           | ::TERM:Directory traversal::TERM:Path traversal:DESCRIPTION:Path traversal is preferred over directory traversal, but both terms are attack-focused.:: | Alternate Terms       |
| Modes_Of_Introduction | 介绍模式                       | ::PHASE:Architecture and Design:NOTE:COMMISSION: This weakness refers to an incorrect design related to an architectural security tactic.::PHASE:Implementation:: | Modes Of Introduction |
| Background_Details    | 背景介绍                       | ::A cursor is a feature in Oracle PL/SQL and other languages that provides a handle for executing and accessing the results of SQL queries.:: | Background Details    |
| Consequences          | 攻击的结果                     | ::SCOPE:Other:IMPACT:Quality Degradation::                   | Common Consequences   |
| Mitigations           | 缓解措施                       | ::PHASE:System Configuration:DESCRIPTION:Avoid releasing debug binaries into the production environment. Change the debug mode to false when the application is deployed into production.:: | Potential Mitigations |
| Detection             | 检测方式                       | ::METHOD:Black Box:DESCRIPTION:Exploitation of a vulnerability with commonly-used manipulations might fail, but minor variations might succeed.:: | Detection Methods     |
| Functional_Areas      | 功能区域                       | Authentication                                               | Functional Areas      |
| Affected_Resources    | 缺陷影响的物理资源             | CPU                                                          | Affected Resources    |
| Notes                 | 额外信息                       | Relationship：This can be resultant from SQL injection vulnerabilities and other issues. | Notes                 |

### 关系

| Subject |                         relationship                         | Object | 意义                              |
| :-----: | :----------------------------------------------------------: | :----: | --------------------------------- |
|   CWE   | CanAlsoBe: 27,<br/>CanPrecede: 135,<br/>ChildOf: 1128,<br/>PeerOf: 97,<br/> Requires: 13,<br/>StartsWith:3 |  CWE   | CWE有层级，有些CWE是别的CWE的子集 |
|   CVE   |                            belong                            |  CWE   | CVE是CWE的具体漏洞实例            |

# CVE

数据源是csv格式，单文件

## CVE

CVE （Common Vulnerabilities & Exposures，通用漏洞和风险）来源于CVE的CVE。

### 属性

属性类型打上问号表示类型未知

| 属性        | 意义      | 样例                                                         | 对象中的名字 |
| ----------- | --------- | ------------------------------------------------------------ | ------------ |
| ID          | 标识号    | CVE-2010-0629                                                | Name         |
| Status      | 状态      | Entry                                                        | Status       |
| Description | 描述      | Use-after-free vulnerability in kadmin/server/server_stubs.c in kadmind in MIT Kerberos 5 (aka krb5) 1.5 through 1.6.3 allows remote authenticated users to cause a denial of service (daemon crash) via a request from a kadmin client that sends an invalid API version number. | Description  |
| Phase       | CVE的阶段 | Assigned (20030324)                                          | Phase        |
| References  | 参考文献  | BID:39247 <br />URL:http://www.securityfocus.com/bid/39247   | References   |

# Car

数据源为yaml格式，多文件

## Analytic

Analytic描述了TTP产生的能被观察到的行为，是识别TPP的方法。具体描述了高级分析假设、伪代码分析实现、单元测试以及用于开发它们的数据模型并映射到特定ATT&CK技术的分析。来源于CAR的Analytic。

### 属性

| 属性               | 意义           | 样例                                                         | 对象中的名字       |
| ------------------ | -------------- | ------------------------------------------------------------ | ------------------ |
| ID                 | 标识号         | CAR-2013-08-001                                              | id                 |
| Name               | 名字           | Execution with schtasks                                      | title              |
| Description        | 描述           | The Windows built-in tool `schtasks.exe` provides the creation, modification, and running of [scheduled tasks](https://attack.mitre.org/techniques/T1053) on a local or remote computer. It is provided as a more flexible alternative to `at.exe`, described in [CAR-2013-05-004](https://car.mitre.org/analytics/CAR-2013-05-004). Although used by adversaries, the tool is also legitimately used by administrators, scripts, and software configurations. The scheduled tasks tool can be used to gain [Persistence](https://attack.mitre.org/tactics/TA0003) and can be used in combination with a [Lateral Movement](https://attack.mitre.org/tactics/TA0008) technique to remotely gain [execution](https://attack.mitre.org/tactics/TA0002). Additionally, the command has parameters to specify the user and password responsible for creating the task, as well as the user and password combination that the task will run as. The `/s` flag specifies the remote system on which the task should be scheduled, usually indicating [Lateral Movement](https://attack.mitre.org/tactics/TA0008). | Description        |
| Submission Date    | 分析提交的时间 | 2013/08/07                                                   | submission_date    |
| Information Domain | 数据的来源     | Host, Network                                                | information_domain |
| Platforms          | 平台           | Windows                                                      | platforms          |
| Subtypes           | 数据类型       | Event Records, File API, PCAP                                | subtypes           |
| Type               | 分析的类型     | Anomaly、TTP                                                 | analytic_types     |
| Implementations    | 实现           | ![image-20211124104653355](%E6%9C%AC%E4%BD%93%E8%AE%BE%E8%AE%A1.assets/image-20211124104653355.png) | implementations    |
| Unit_tests         | 单元测试       | ![image-20211124104704543](%E6%9C%AC%E4%BD%93%E8%AE%BE%E8%AE%A1.assets/image-20211124104704543.png) | unit_tests         |

### 关系

|     Subject     | relationship |  Object  | 意义                           |
| :-------------: | :----------: | :------: | ------------------------------ |
| (Sub) Technique |   analysed   | Analytic | （子）攻击技术被Analytic所分析 |
|    Analytic     |   related    |  Field   | Analytic相关的数据的字段       |
|    Analytic     |   related    |  Action  | Analytic相关的数据的操作       |

## Sensor

Sensors是收集可用于运行分析数据的工具。来源于CAR的Sensors。

### 属性

| 属性        | 意义     | 样例                                                         | 对象中的名字       |
| ----------- | -------- | ------------------------------------------------------------ | ------------------ |
| Name        | 名字     | Sysmon (10.4)                                                | sensor_name        |
| Developer   | 制造商   | Microsoft                                                    | developer          |
| Version     | 版本     | 10.4                                                         | sensor_version     |
| Url         | 官方网站 | https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon | url                |
| Description | 描述     | Sysmon is a freely available program from Microsoft that is provided as part of the Windows Sysinternals suite of tools. It collects system information while running in the background and supports storing it in the Windows Event Log. | sensor_description |

### 关系

| Subject  | relationship |   Object   | 意义                     |
| :------: | :----------: | :--------: | ------------------------ |
| Analytic |   related    |   Sensor   | 适用于Analytic的Sensor   |
|  Sensor  |   coverage   | Data Model | Analytic中涉及的数据模型 |

## Data Model

Data Model是基于主机或基于网络的角度监视的对象。每个对象都可以通过两个维度来标识：其操作和字段。当配对在一起时，三元组`(object, action, field)`就像一个坐标，描述了传感器可以捕获对象的哪些属性和状态变化。

来源于CAR的Data Model。

### 属性

| 属性        | 意义 | 样例                                                         | 对象中的名字 |
| ----------- | ---- | ------------------------------------------------------------ | ------------ |
| Name        | 名字 | HTTP                                                         | name         |
| Description | 描述 | HTTP events represents requests made over the network via the HTTP protocol. | description  |

### 关系

| Subject | relationship |   Object   | 意义               |
| :-----: | :----------: | :--------: | ------------------ |
| Action  |    belong    | Data Model | 数据模型包含的操作 |
|  Field  |    belong    | Data Model | 数据模型包含的字段 |

## Action

数据模型包含的操作

### 属性

| 属性        | 意义 | 样例                                             | 对象中的名字 |
| ----------- | ---- | ------------------------------------------------ | ------------ |
| Name        | 名字 | post                                             | name         |
| Description | 描述 | The event corresponding to an HTTP POST request. | description  |
| Label       | 标志 | HTTP/post                                        | label        |

## Field

数据模型包含的字段

### 属性

| 属性        | 意义 | 样例                                          | 对象中的名字 |
| ----------- | ---- | --------------------------------------------- | ------------ |
| Name        | 名字 | http_version                                  | name         |
| Description | 描述 | HTTP version that is specified in the header. | description  |
| Label       | 标志 | HTTP/http_version                             | label        |
| Example     | 样例 | 1.1                                           | example      |

# D3FEND

数据源是json格式，单文件

## Technique

（子）攻击技术，用于构建关系

### 属性

| 属性 |           意义           | 样例                 |    对象中的名字     |
| :--: | :----------------------: | -------------------- | :-----------------: |
|  ID  | ATT&CK中攻击技术的标识号 | T1518<br />T1518.001 | external_references |
| Name |  ATT&CK中攻击技术的名字  | Software Discovery   |        name         |

### 关系

|  Subject  |                         relationship                         |  Object  |             意义             |
| :-------: | :----------------------------------------------------------: | :------: | :--------------------------: |
| Technique | accesses: 49,<br/>adds: 11,<br/>connects: 1,<br/>copies: 3,<br/>creates: 33,<br/>deletes: 1,<br/>disables: 2,<br/>executes: 8,<br/>forges: 2,<br/>hides: 1,<br/>injects: 2,<br/>installs: 1,<br/>interprets: 1,<br/>invokes: 23,<br/>loads: 5,<br/>may-access: 14,<br/>may-add: 6,<br/>may-create: 16,<br/>may-invoke: 2,<br/>may-modify: 63,<br/>may-produce: 9,<br/>may-run: 1,<br/>may-transfer: 5,<br/>modifies: 106,<br/>obfuscates: 1,<br/>produces: 74,<br/>queries: 1,<br/>reads: 5,<br/>runs: 1,<br/>unmounts: 1,<br/>uses: 6 | Artifact | 攻击技术与数字工件之间的关系 |

## DefensiveTarget

防御性战术的目标

### 属性

| 属性        | 意义   | 样例                                                         | 对象中的名字   |
| ----------- | ------ | ------------------------------------------------------------ | -------------- |
| ID          | 标识号 | d3f:HomoglyphDetection                                       | @id            |
| Name        | 名字   | Homoglyph Detection                                          | rdfs:label     |
| Description | 描述   | Comparing strings using a variety of techniques to determine if a deceptive or malicious string is being presented to a user. | d3f:definition |

## DefensiveTactic

防御性战术，对标战术Tactic

### 属性

| 属性        | 意义   | 样例                                                         | 对象中的名字   |
| ----------- | ------ | ------------------------------------------------------------ | -------------- |
| ID          | 标识号 | d3f:DecoyObject                                              | @id            |
| Name        | 名字   | Decoy Object                                                 | rdfs:label     |
| Description | 描述   | A Decoy Object is created and deployed for the purposes of deceiving attackers. | d3f:definition |

### 关系

|     Subject     | relationship |     Object      | 意义           |
| :-------------: | :----------: | :-------------: | -------------- |
| DefensiveTactic |    belong    | DefensiveTarget | 防御战术的目标 |

## DefensiveTechnique

防御性技术，对标技术Technique

### 属性

| 属性        | 意义     | 样例                                                         | 对象中的名字   |
| ----------- | -------- | ------------------------------------------------------------ | -------------- |
| ID          | 标识号   | d3f:RelayPatternAnalysis                                     | @id            |
| Name        | 名字     | RelayPatternAnalysis                                         | rdfs:label     |
| Description | 描述     | The detection of an internal host relaying traffic between the internal network and the external network. | d3f:definition |
| Content     | 具体内容 | \## How it works\nA relay may use a variety of proxying, forwarding, or routing technologies to bridge a protected network with an external network. A defensive analytic to detect a relay network may compare the network sessions among multiple hosts. Hosts which have nearly similar network statistics may be part of a relay network. The statistics may include number of bytes sent to and from, time of session initiation, packet size, or packet arrival time data.\n\n## Considerations\n\nComplex intranet VPNs or routing encapsulation may affect the detection analytics.  In addition, unwanted packets might not be forwarded, and additional packets may be added at the relay, further complicating detection. | d3f:kb-article |
| Synonym     | 同义词   | Relay Network Detection                                      | synonym        |

### 关系

|      Subject       |                         relationship                         |       Object       | 意义                         |
| :----------------: | :----------------------------------------------------------: | :----------------: | ---------------------------- |
| DefensiveTechnique |                            belong                            |  DefensiveTactic   | 防御技术所属的防御战术       |
| DefensiveTechnique |                           superior                           | DefensiveTechnique | 防御技术是防御技术的子技术   |
| DefensiveTechnique |                            refer                             |     Reference      | 参考文献                     |
| DefensiveTechnique | analyzes: 54,<br/>authenticates: 7,<br/>blocks: 8,<br/>deletes: 1,<br/>disables: 1,<br/>encrypts: 2,<br/>filters: 6,<br/>hardens: 1,<br/>isolates: 3,<br/>may-contain: 1,<br/>monitors: 2,<br/>neutralizes: 1,<br/>obfuscates: 1,<br/>restricts: 5,<br/>spoofs: 8,<br/>strengthens: 2,<br/>terminates: 1,<br/>updates: 1,<br/>use-limits: 1,<br/>validates: 2,<br/>verifies: 4 |      Artifact      | 防御技术与数字工件之间的关系 |

## Artifact

数字工件

### 属性

| 属性        | 意义   | 样例                                                         | 对象中的名字 |
| ----------- | ------ | ------------------------------------------------------------ | ------------ |
| ID          | 标识号 | d3f:Clipboard                                                | @id          |
| Name        | 名字   | Clipboard                                                    | rdfs:label   |
| Description | 描述   | The clipboard is a buffer that some operating systems provide for short-term storage and transfer within and between application programs. The clipboard is usually temporary and unnamed, and its contents reside in the computer's RAM. The clipboard is sometimes called the paste buffer. Windows, Linux and macOS support a single clipboard transaction. Each cut or copy overwrites the previous contents. Normally, paste operations copy the contents, leaving the contents available in the clipboard for further pasting. | rdfs:comment |

### 关系

| Subject  |                         relationship                         |  Object  | 意义                         |
| :------: | :----------------------------------------------------------: | :------: | ---------------------------- |
| Artifact | accesses: 3,<br />addressed-by: 1,<br />addresses: 3,<br />attached-to: 1,<br />authenticates: 2,<br />authorizes: 1,<br />configures: 1,<br />contains: 46,<br />creates: 1,<br />drives: 2,<br />executes: 1,<br />extends: 1,<br />has-account: 1,<br />has-recipient: 1,<br />has-sender: 1,<br />interprets: 1,<br />loads: 1,<br />manages: 2,<br />may-contain: 23,<br />may-create: 2,<br />may-interpret: 1,<br />modifies: 1,<br />originates-from: 2,<br />process-image-path: 1,<br />process-user: 1,<br />produces: 1,<br />reads: 1,<br />records: 3,<br />runs: 4,<br />subClassOf: 465,<br />summarizes: 1,<br />uses: 1 | Artifact | 数字工件与数字工件之间的关系 |

## Reference

参考文献

### 属性

|    属性     |  意义  |                             样例                             |
| :---------: | :----: | :----------------------------------------------------------: |
|    Name     | 资源名 |                         mitre-attack                         |
|     Url     |  url   |           https://attack.mitre.org/tactics/TA0011            |
| Description |  描述  | kubernetes. (n.d.). cluster-info. Retrieved October 13, 2021. |

### 
